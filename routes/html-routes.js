var path=require("path");const db=require("../models"),consts=require("../utils/consts");var axios=require("axios");module.exports=function(a){a.get("/",function(a,b){if(a.cookies.uuid)db.User.findOne({where:{cookie:a.cookies.uuid}}).then(a=>{if(a){var c={headers:{Authorization:`token ${a.dataValues.accessToken}`}};axios.get(consts.GITHUB_USER_URL,c).then(()=>{b.redirect("/main")}).catch(()=>{var a=consts.SIGN_UP_URL+process.env.GITHUB_CLIENT_ID;b.render("signup",{link:a})})}else{var d=consts.SIGN_UP_URL+process.env.GITHUB_CLIENT_ID;b.render("signup",{link:d})}});else{var c=consts.SIGN_UP_URL+process.env.GITHUB_CLIENT_ID;b.render("signup",{link:c})}})};